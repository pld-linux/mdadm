- spec adaptterized, added more macros and few other minor changes.
